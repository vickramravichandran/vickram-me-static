
<!DOCTYPE html>
<!--[if IE]><![endif]-->
<!--[if lt IE 7 ]> <html lang="en" class="ie6"> <![endif]-->
<!--[if IE 7]> <html lang="en" class="ie7"> <![endif]-->
<!--[if IE 8]> <html lang="en" class="ie8"> <![endif]-->
<!--[if IE 9 ]> <html lang="en" class="ie9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!-->
<html lang="en">
<!--<![endif]-->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="msvalidate.01" content="" />

    <title>OracleDataReader GetOrDefault() extension method | Vickram Ravichandran</title>

    
<link rel="shortcut icon" href="/static/favicons/favicon.ico">
<link rel="apple-touch-icon" sizes="57x57" href="/static/favicons/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/static/favicons/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/static/favicons/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/static/favicons/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/static/favicons/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/static/favicons/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/static/favicons/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/static/favicons/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/static/favicons/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="16x16" href="/static/favicons/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/static/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="/static/favicons/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="192x192" href="/static/favicons/android-icon-192x192.png">
<link rel="manifest" href="/static/favicons/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/static/favicons/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">


    <link href='https://fonts.googleapis.com/css?family=Roboto:400,700,500,400italic' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Open+Sans+Condensed:300,700' rel='stylesheet' type='text/css'>
    
    
    <link rel="canonical" href="http://www.vickram.me/oracle-data-reader-getordefault-extension-method" />
    <meta name="keywords" content="c#, extension, Oracle, ODP.NET" />

    
<meta property="og:site_name" content="Vickram Ravichandran" />
<meta property="og:type" content="article" />
<meta property="og:title" content="OracleDataReader GetOrDefault() extension method" />
<meta property="og:description" content="The various GetXXX methods of the OracleDataReader class take a zero-based column index instead of the column name. Referring columns by index instead of name leads to hard to understand code. Additionally, the code may be susceptible to errors if the column order is modified." />
<meta property="og:url" content="http://www.vickram.me/oracle-data-reader-getordefault-extension-method" />

    <meta property="article:tag" content="c#" />
    <meta property="article:tag" content="extension" />
    <meta property="article:tag" content="Oracle" />
    <meta property="article:tag" content="ODP.NET" />

    
<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="OracleDataReader GetOrDefault() extension method" />
<meta name="twitter:description" content="The various GetXXX methods of the OracleDataReader class take a zero-based column index instead of the column name. Referring columns by index instead of name leads to hard to understand code. Additionally, the code may be susceptible to errors if the column order is modified." />
<meta name="twitter:url" content="http://www.vickram.me/oracle-data-reader-getordefault-extension-method" />
<meta name="twitter:label1" content="Written by" />
<meta name="twitter:data1" content="Vickram Ravichandran" />
<meta name="twitter:label2" content="Filed under" />
<meta name="twitter:data2" content="c#, extension, Oracle, ODP.NET" />


    
<script type="application/ld+json">
    {
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Vickram Ravichandran",
        "logo": "https://vickram.blob.core.windows.net/images/vickram-ravichandran.png?sv=2017-04-17&ss=b&srt=o&sp=r&se=2050-10-15T01:20:16Z&st=2017-10-14T17:20:16Z&spr=https&sig=HW39593GSHaPDTL%2F1BqWDWOaNQczc5ZGnPLRzUswd8k%3D"
    },
    "author": {
        "@type": "Person",
        "name": "Vickram Ravichandran",
        "url": "http://www.vickram.me/author/vickramravichandran/",
        "sameAs": [ "https://www.linkedin.com/in/vickramravichandran" ]
    },
    "headline": "OracleDataReader GetOrDefault() extension method",
    "url": "http://www.vickram.me/oracle-data-reader-getordefault-extension-method",
    "keywords": "c#, extension, Oracle, ODP.NET",
    "description": "The various GetXXX methods of the OracleDataReader class take a zero-based column index instead of the column name. Referring columns by index instead of name leads to hard to understand code. Additionally, the code may be susceptible to errors if the column order is modified.",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://www.vickram.me"
        }
    }
</script>





    
<script type="application/ld+json">
    {
        "@context": "http://schema.org/",
        "@type": "Person",
        "name": "Vickram Ravichandran",
        "image":"https://vickram.blob.core.windows.net/images/vickram-ravichandran.png?sv=2017-04-17&ss=b&srt=o&sp=r&se=2050-10-15T01:20:16Z&st=2017-10-14T17:20:16Z&spr=https&sig=HW39593GSHaPDTL%2F1BqWDWOaNQczc5ZGnPLRzUswd8k%3D",
        "jobTitle": "Senior Software Engineer",
        "url": "http://www.vickram.me",
        "sameAs" : [ https://www.linkedin.com/in/vickramravichandran, "http://www.vickramravichandran.com" ]
    }
</script>


    <link href="../app.css?v=mIPojOEcdz6Ph8_jbR0rTCs2IrCTDCJgDc6iGtpOEns1" rel="stylesheet"/>


    
    

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
</head>
<body>
    


<div class="sidebar">

    <header class="header" role="banner">
        <a href="http://www.vickram.me">
            <img id="blog" class="logo" src="https://vickram.blob.core.windows.net/images/vickram-ravichandran.png?sv=2017-04-17&ss=b&srt=o&sp=r&se=2050-10-15T01:20:16Z&st=2017-10-14T17:20:16Z&spr=https&sig=HW39593GSHaPDTL%2F1BqWDWOaNQczc5ZGnPLRzUswd8k%3D">
        </a>
        
        <h1 class="title">
            <a href="http://www.vickram.me" style="text-decoration:none">Vickram Ravichandran</a>
        </h1>
        <p class="description"></p>

        <div class="separator"></div>
        
        <nav class="main-nav responsive">
            <ul>
                <li><a href="http://www.vickram.me">Home</a></li>
            </ul>
        </nav>

        <div class="social-icons">
            <a href="http://www.vickram.me" class="icon icon-home"></a>
            <a href="https://www.linkedin.com/in/vickramravichandran" class="icon icon-linkedin"></a>
            <a href="https://github.com/vickramravichandran" class="icon icon-github-circled"></a>
        </div>

    </header>

</div>


    <div class="content">
        <main role="main">
            

<link rel="amphtml" href="http://www.vickram.me/oracle-data-reader-getordefault-extension-method/amp/" />



<article class="post tag-c, tag-extension, tag-oracle, tag-odp-net" role="article" itemscope itemtype="http://schema.org/Article">
    <h1 class="post-title">OracleDataReader GetOrDefault() extension method</h1>
    <span class="post-meta">
        
        by Vickram Ravichandran
    </span>
    <section class="post-content">
        <p>The various GetXXX methods of the <code>OracleDataReader</code> class take the zero-based column index instead of the column name. Referring columns by index instead of name leads to hard to understand code. Additionally, the code may be susceptible to errors if the column order is modified.</p>
<p>We might write something like this if the columns returned from a database procedure are <code>emp_name</code>, <code>hire_date</code> and <code>salary</code> in that order,</p>
<pre><code class="language-csharp">string empName;
DateTime hireDate;
double salary;

empName = dr.GetString(0);

// check for IsDBNull before getting the column data
if (!dr.IsDBNull(1))
{
    hireDate = dr.GetDateTime(1);
}

if (!dr.IsDBNull(2))
{
    salary = dr.GetDouble(2);
}
</code></pre>
<p>With the <code>OracleDataReader</code> extension method, the code is significantly reduced.</p>
<pre><code class="language-csharp">// default to &quot;Unknown&quot; if database value is NULL
string empName = dr.GetOrDefault&lt;string&gt;(&quot;emp_name&quot;, &quot;Unknown&quot;);

// default to DateTime.MinValue if database value is NULL
DateTime hireDate = dr.GetOrDefault&lt;DateTime&gt;(&quot;hire_date&quot;);

// default to 0 if database value is NULL
double salary = dr.GetOrDefault&lt;double&gt;(&quot;salary&quot;);
</code></pre>
<p>The second parameter is returned if the first parameter is <code>null</code> or <code>DBNull.value</code>. I created the <code>GetOrDefault</code> as a static method of the <code>Helper</code> class for reusability.</p>
<pre><code class="language-csharp">namespace App.Helpers
{
    public class Helper
    {
        public static T GetOrDefault&lt;T&gt;(
            object value,
            T defaultValue = default(T))
        {
            // do not use GetType()
            // IsNullableType requires typeof to work correctly
            Type type = typeof(T);

            if (value == DBNull.Value 
               || value == null
               || string.IsNullOrEmpty(Convert.ToString(value)))
            {
                return defaultValue;
            }

            // if type is nullable then get the underlying type
            if (IsNullableType(type))
            {
                type = Nullable.GetUnderlyingType(typeof(T));
            }

            return (T)Convert.ChangeType(value, type);
        }

        /// &lt;summary&gt;
        /// Refer http://msdn.microsoft.com/en-us/library/ms366789.aspx
        /// Use the following code to determine whether a Type object
        /// represents a Nullable type. 
        /// Remember that this code always returns false if the Type object 
        /// was returned from a call to GetType.
        /// &lt;/summary&gt;
        public static bool IsNullableType(Type type)
        {
            return type.IsGenericType 
                   &amp;&amp; type.GetGenericTypeDefinition()
                          .Equals(typeof(Nullable&lt;&gt;));
        }
    }
}
</code></pre>
<p>Here is the extension method on the <code>OracleDataReader</code> class that calls the helper method.</p>
<pre><code class="language-csharp">namespace App.Helpers
{
    public static class Extensions
    {
        public static T GetOrDefault&lt;T&gt;(
             this OracleDataReader dr,
             string fieldName,
             T defaultValue = default(T))
        {
            try
            {
                return Helper.GetValue&lt;T&gt;(dr[fieldName], defaultValue);
            }
            catch (IndexOutOfRangeException ex)
            {
                throw new IndexOutOfRangeException(string.Format(&quot;Unable to find column '{0}' in the result set&quot;, fieldName), ex);
            }
        }
    }
}
</code></pre>

    </section>

    
<div class="post-meta">
    <div class="post-tags icon-tag">
            <a href="/tag/c/">c#</a>  •             <a href="/tag/extension/">extension</a>  •             <a href="/tag/oracle/">Oracle</a>  •             <a href="/tag/odp-net/">ODP.NET</a>     </div>
</div>

    

<footer class="post-footer">
    <section class="share">
        <h4 class="post-share">Share this post</h4>
        <ul>
            <li>
                <a href="https://plus.google.com/share?url=http://www.vickram.me/oracle-data-reader-getordefault-extension-method"
                    onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <i class="icon icon-gplus"></i>
                </a>
            </li>
            <li>
                <a href="https://twitter.com/share?text=OracleDataReader+GetOrDefault()+extension+method;url=http://www.vickram.me/oracle-data-reader-getordefault-extension-method"
                    onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <i class="icon icon-twitter"></i>
                </a>
            </li>
            <li>
                <a href="https://www.facebook.com/sharer/sharer.php?u=http://www.vickram.me/oracle-data-reader-getordefault-extension-method"
                    onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <i class="icon icon-facebook"></i>
                </a>
            </li>
        </ul>
    </section>
</footer>

    
<section class="post-comments">
    <div id="disqus_thread"></div>
    <script>
        /**
        * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
        * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
        */

        var disqus_config = function () {
            this.page.url = "http://www.vickram.me/oracle-data-reader-getordefault-extension-method";
            this.page.identifier = "oracle-data-reader-getordefault-extension-method";
            this.page.title = "OracleDataReader GetOrDefault() extension method";
        };

        (function () { // DON'T EDIT BELOW THIS LINE
            var d = document, s = d.createElement('script');

            s.src = '//vickram.disqus.com/embed.js';

            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
</section>

</article>


        </main>
    </div>

    <script src="../app.js?v=_QvRy-x53dGG35wUxtaekHJdHwwEkHFwZztABa1JJJM1"></script>


</body>
</html>
